<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.UreportTemplatesMapper">

    <!-- 结果映射（补充 create_by 和 update_by 字段） -->
    <resultMap id="BaseResultMap" type="ureportTemplates">
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="name" property="name" jdbcType="VARCHAR" />
        <result column="content" property="content" jdbcType="BLOB" />
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
        <result column="create_by" property="createBy" jdbcType="VARCHAR" />
        <result column="update_by" property="updateBy" jdbcType="VARCHAR" />
    </resultMap>

    <!-- 根据名称查询（补充 select 列） -->
    <select id="selectByName" resultMap="BaseResultMap" parameterType="string">
        SELECT id, name, content, create_time, update_time, create_by, update_by
        FROM ureport_file_tbl
        WHERE name = #{name}
    </select>

    <!-- 插入数据（补充 create_by 和 update_by 字段） -->
    <insert id="insert" parameterType="ureportTemplates">
        INSERT INTO ureport_file_tbl
        (name, content, create_time, update_time, create_by, update_by)
        VALUES
        (#{name}, #{content}, #{createTime}, #{updateTime}, #{createBy}, #{updateBy})
    </insert>

    <update id="update" parameterType="ureportTemplates">
        UPDATE ureport_file_tbl
        SET content = #{content},
        update_time = #{updateTime},
        update_by = #{updateBy}  <!-- 新增 -->
        WHERE name = #{name}
    </update>

    <!-- 列表查询（补充 select 列） -->
    <select id="selectList" resultMap="BaseResultMap" parameterType="ureportTemplates">
        SELECT id, name, content, create_time, update_time, create_by, update_by
        FROM ureport_file_tbl
        <where>
            <if test="name != null and name != ''">
                AND name LIKE CONCAT('%', #{name}, '%')
            </if>
        </where>
    </select>
</mapper>
